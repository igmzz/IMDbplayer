<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>IMDb Player</title>
<link rel="icon" href="carrete-de-pelicula.ico" type="image/x-icon" />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<style>
  :root {
    --bg-primary: #0a0a0a;
    --bg-secondary: #1a1a2e;
    --bg-card: rgba(20,20,40,0.8);
    --text-primary: #ffffff;
    --text-secondary: #e2e8f0;
    --accent-primary: #667eea;
    --accent-secondary: #764ba2;
    --border-color: rgba(255,255,255,0.05);
  }
  
  [data-theme="light"] {
    --bg-primary: #fafbfc;
    --bg-secondary: #e8f0fe;
    --bg-card: rgba(255,255,255,0.95);
    --text-primary: #1a202c;
    --text-secondary: #4a5568;
    --accent-primary: #2d3748;
    --accent-secondary: #1a202c;
    --border-color: #cbd5e0;
    --input-bg: rgba(255,255,255,0.98);
    --input-placeholder: rgba(0,0,0,0.5);
    --button-gradient: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
    --card-border: 1px solid #cbd5e0;
    --shadow-light: 0 4px 20px rgba(0,0,0,0.06);
    --shadow-hover: 0 8px 30px rgba(0,0,0,0.12);
  }

  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    font-family: "Inter", -apple-system, BlinkMacSystemFont, sans-serif;
  }
  html, body {
    height: 100%;
    width: 100%;
    overflow-y: scroll;
    overflow-x: hidden;
    scroll-behavior: smooth;
    background: var(--bg-primary);
    transition: background-color 0.3s ease, color 0.3s ease;
  }
  body {
    background: 
      radial-gradient(ellipse at top left, rgba(120,119,198,0.1) 0%, transparent 50%),
      radial-gradient(ellipse at bottom right, rgba(255,119,198,0.1) 0%, transparent 50%),
      linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 50%, #16213e 100%);
    background-attachment: fixed;
    color: var(--text-primary);
    position: relative;
    transition: background 0.3s ease;
  }
  [data-theme="light"] body {
    background: 
      linear-gradient(135deg, #f7fafc 0%, #edf2f7 50%, #e2e8f0 100%);
  }
  body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: 
      url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.03'%3E%3Ccircle cx='30' cy='30' r='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E"),
      url("data:image/svg+xml,%3Csvg width='40' height='40' viewBox='0 0 40 40' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23ffffff' fill-opacity='0.02'%3E%3Ccircle cx='20' cy='20' r='1'/%3E%3C/g%3E%3C/svg%3E");
    background-size: 60px 60px, 40px 40px;
    background-position: 0 0, 20px 20px;
    pointer-events: none;
    z-index: -1;
    opacity: 0.5;
  }
  [data-theme="light"] body::before {
    display: none;
  }
  
  /* Theme Toggle */
  #themeToggle {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 10000;
    background: var(--bg-card);
    border: 1px solid var(--border-color);
    border-radius: 50px;
    padding: 0.5rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    transition: all 0.3s ease;
    backdrop-filter: blur(20px);
    color: var(--text-primary);
  }
  #themeToggle:hover {
    box-shadow: var(--shadow-light);
    transform: scale(1.05);
  }
  #themeToggle i {
    font-size: 1.2rem;
    transition: opacity 0.3s ease;
  }
  #themeToggle[data-theme="dark"] .fa-sun { opacity: 0.5; }
  #themeToggle[data-theme="dark"] .fa-moon { opacity: 1; }
  #themeToggle[data-theme="light"] .fa-sun { opacity: 1; }
  #themeToggle[data-theme="light"] .fa-moon { opacity: 0.5; }
  #themeToggle::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 0.5rem;
    width: 20px;
    height: 20px;
    background: var(--accent-primary);
    border-radius: 50%;
    transform: translateY(-50%);
    transition: left 0.3s ease;
    box-shadow: 0 2px 8px rgba(51,65,85,0.3);
    z-index: 1;
  }
  #themeToggle[data-theme="light"]::after { left: calc(100% - 25px); }
  
  /* Loading Spinner */
  #loadingSpinner {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 9999;
    border: 4px solid var(--bg-secondary);
    border-top: 4px solid var(--accent-primary);
    border-radius: 50%;
    width: 50px;
    height: 50px;
    animation: spin 1s linear infinite;
  }
  @keyframes spin {
    0% { transform: translate(-50%, -50%) rotate(0deg); }
    100% { transform: translate(-50%, -50%) rotate(360deg); }
  }

  #main {
    display: flex;
    flex-direction: column;
    padding: 2rem;
    max-width: 1400px;
    margin: 0 auto;
    min-height: 100vh;
  }
  h2 {
    margin-bottom: 2.5rem;
    text-align: center;
    font-weight: 800;
    letter-spacing: -0.02em;
    font-size: 2.8rem;
    line-height: 1.1;
  }
  [data-theme="dark"] h2 {
    color: var(--text-primary);
    background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-shadow: 0 0 30px rgba(102, 126, 234, 0.3);
  }
  [data-theme="light"] h2 {
    color: var(--accent-secondary);
    text-shadow: 0 2px 4px rgba(0,0,0,0.1);
  }
  #modeSelector {
    display: flex;
    justify-content: center;
    gap: 1.5rem;
    margin-bottom: 3rem;
    flex-wrap: wrap;
  }
  #modeSelector button {
    padding: 1rem 2.5rem;
    font-size: 1.1rem;
    font-weight: 600;
    border: 1px solid var(--border-color);
    border-radius: 16px;
    background: var(--bg-card);
    color: var(--text-primary);
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    backdrop-filter: blur(20px);
    position: relative;
    overflow: hidden;
  }
  [data-theme="light"] #modeSelector button {
    background: var(--bg-card);
    border: var(--card-border);
    box-shadow: var(--shadow-light);
  }
  #modeSelector button::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
    transition: left 0.5s;
  }
  #modeSelector button:hover::before {
    left: 100%;
  }
  #modeSelector button:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-hover);
    border-color: var(--accent-primary);
  }
  [data-theme="light"] #modeSelector button:hover {
    background: rgba(255,255,255,0.8);
    border-color: var(--accent-primary);
  }
  #searchContainer {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 1rem;
    margin-bottom: 2rem;
  }
  input, button.action-btn {
    font-family: "Inter", sans-serif;
  }
  input {
    padding: 1rem 1.5rem;
    font-size: 1rem;
    border-radius: 12px;
    border: 1px solid var(--border-color);
    outline: none;
    background: var(--input-bg, var(--bg-card));
    color: var(--text-primary);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    backdrop-filter: blur(10px);
    font-weight: 500;
  }
  [data-theme="light"] input {
    border: var(--card-border);
    box-shadow: var(--shadow-light);
  }
  input::placeholder {
    color: var(--input-placeholder, rgba(255,255,255,0.4));
  }
  input:focus {
    border-color: var(--accent-primary);
    transform: translateY(-2px);
    box-shadow: 0 0 0 3px rgba(45,55,72,0.1);
  }
  button.action-btn {
    padding: 1rem 2rem;
    font-size: 1rem;
    font-weight: 600;
    border-radius: 12px;
    background: var(--button-gradient, linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%));
    color: #ffffff;
    border: none;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
  }
  button.action-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
    transition: left 0.5s;
  }
  button.action-btn:hover::before {
    left: 100%;
  }
  button.action-btn:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-hover);
  }
  #results {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 2rem 2.5rem;
    padding: 0;
  }
  .card, .subs-card {
    background: var(--bg-card);
    width: 160px;
    border-radius: 20px;
    overflow: hidden;
    box-shadow: var(--shadow-light);
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    flex-direction: column;
    align-items: center;
    backdrop-filter: blur(10px);
    border: var(--card-border);
  }
  [data-theme="light"] .card, [data-theme="light"] .subs-card {
    background: rgba(255,255,255,0.95);
    box-shadow: var(--shadow-light);
  }
  .card:hover, .subs-card:hover {
    transform: translateY(-12px) scale(1.02);
    box-shadow: var(--shadow-hover);
    border-color: var(--accent-primary);
  }
  .poster {
    width: 160px;
    height: 240px;
    object-fit: cover;
    border-bottom: 1px solid var(--border-color);
    transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  }
  .card:hover .poster, .subs-card:hover .poster {
    transform: scale(1.05);
  }
  .title {
    padding: 1rem;
    font-weight: 600;
    font-size: 0.9rem;
    color: var(--text-secondary);
    text-align: center;
    user-select: none;
    height: 3.5rem;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    line-height: 1.3;
  }
  .expanded-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    background: var(--bg-card);
    padding: 2rem;
    border-radius: 24px;
    width: 90%;
    max-width: 900px;
    margin: 0 auto 2rem auto;
    box-shadow: var(--shadow-hover);
    text-align: center;
    opacity: 0;
    transform: translateY(30px);
    animation: fadeSlideIn 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    backdrop-filter: blur(20px);
    border: var(--card-border);
    color: var(--text-secondary);
  }
  [data-theme="light"] .expanded-card {
    background: rgba(255,255,255,0.95);
    box-shadow: var(--shadow-hover);
  }
  @keyframes fadeSlideIn {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  .expanded-card img {
    width: 180px;
    height: 270px;
    object-fit: cover;
    border-radius: 20px;
    margin-bottom: 1.5rem;
    box-shadow: var(--shadow-light);
  }
  .expanded-info {
    color: var(--text-secondary);
    font-size: 1rem;
    line-height: 1.7;
  }
  .expanded-info h3 {
    margin-bottom: 1.5rem;
    font-weight: 700;
    background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
  [data-theme="light"] .expanded-info h3 {
    background: none;
    color: var(--accent-secondary);
  }
  #playerControls {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    margin-top: 1rem;
    position: relative;
  }
  #playerChoiceModal {
    display: none;
    position: fixed;
    z-index: 20000;
    left: 0;
    top: 0;
    width: 100vw;
    height: 100vh;
    background-color: rgba(0,0,0,0.7);
    justify-content: center;
    align-items: center;
    backdrop-filter: blur(10px);
  }
  #playerChoiceContent {
    background: var(--bg-card);
    border-radius: 24px;
    padding: 2.5rem;
    width: 400px;
    box-shadow: var(--shadow-hover);
    text-align: center;
    color: var(--text-secondary);
    border: var(--card-border);
    backdrop-filter: blur(20px);
  }
  [data-theme="light"] #playerChoiceContent {
    background: rgba(255,255,255,0.95);
  }
  #playerChoiceContent h3 {
    margin-bottom: 2rem;
    color: var(--text-primary);
    font-weight: 700;
    background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
  [data-theme="light"] #playerChoiceContent h3 {
    background: none;
    color: var(--accent-secondary);
  }
  .playerChoiceBtn {
    background: var(--button-gradient);
    border: none;
    color: #ffffff;
    font-size: 1.1rem;
    font-weight: 600;
    padding: 1rem 0;
    margin: 0.75rem 0;
    border-radius: 12px;
    width: 100%;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
  }
  .playerChoiceBtn:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-hover);
  }
  #playerChoiceCancelBtn {
    background: transparent;
    border: none;
    color: var(--text-secondary);
    margin-top: 1rem;
    font-size: 0.9rem;
    cursor: pointer;
    font-weight: 500;
    transition: color 0.3s ease;
  }
  #playerChoiceCancelBtn:hover {
    color: var(--accent-primary);
  }
  #movieSynopsisBox {
    max-width: 900px;
    margin: 2rem auto 3rem auto;
    font-size: 1.1rem;
    line-height: 1.6;
    padding: 1.5rem;
    color: var(--text-secondary);
    background: var(--bg-card);
    border-radius: 16px;
    border: var(--card-border);
    backdrop-filter: blur(10px);
    box-shadow: var(--shadow-light);
  }
  [data-theme="light"] #movieSynopsisBox {
    background: rgba(255,255,255,0.95);
  }
  #similarMoviesSection {
    max-width: 1000px;
    margin: 0 auto 4rem auto;
    text-align: center;
  }
  #similarMoviesSection h3 {
    color: var(--text-primary);
    background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 2rem;
    font-weight: 700;
    font-size: 1.5rem;
  }
  [data-theme="light"] #similarMoviesSection h3 {
    background: none;
    color: var(--accent-secondary);
  }
  #similarMovies {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 1.5rem 2rem;
  }
  .similar-card {
    background: var(--bg-card);
    width: 140px;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: var(--shadow-light);
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    flex-direction: column;
    align-items: center;
    backdrop-filter: blur(10px);
    border: var(--card-border);
  }
  [data-theme="light"] .similar-card {
    background: rgba(255,255,255,0.95);
  }
  .similar-card:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: var(--shadow-hover);
    border-color: var(--accent-primary);
  }
  .similar-poster {
    width: 140px;
    height: 200px;
    object-fit: cover;
    border-bottom: 1px solid var(--border-color);
    transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }
  #footballEmbedWrapper {
    width: 100%;
    max-width: 1400px;
    height: 720px;
    margin: 0 auto;
    border-radius: 20px;
    overflow: hidden;
    box-shadow: var(--shadow-hover);
    position: relative;
    background: #000;
    border: var(--card-border);
  }
  [data-theme="light"] #footballEmbedWrapper {
    box-shadow: var(--shadow-hover);
  }
  #footballEmbedWrapper iframe {
    width: 100%;
    height: 100%;
    border: none;
  }
  #footballDropdown {
    position: absolute;
    top: 1rem;
    left: 1rem;
    z-index: 10001;
  }
  #footballDropdown select {
    padding: 0.75rem 1rem;
    border-radius: 12px;
    border: var(--card-border);
    font-size: 1rem;
    background: var(--bg-card);
    color: var(--text-secondary);
    cursor: pointer;
    outline: none;
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
    font-weight: 500;
  }
  [data-theme="light"] #footballDropdown select {
    background: rgba(255,255,255,0.95);
  }
  #footballDropdown select:hover {
    border-color: var(--accent-primary);
  }
  #subtitleExtensionBtn {
    position: absolute;
    top: 1rem;
    right: -60px;
    width: 48px;
    height: 48px;
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    border-radius: 50%;
    cursor: pointer;
    overflow: hidden;
    white-space: nowrap;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 600;
    font-size: 0.75rem;
    box-shadow: 0 10px 25px rgba(16, 185, 129, 0.3);
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    padding: 0;
    text-decoration: none;
    z-index: 10002;
    border: 1px solid rgba(255,255,255,0.1);
  }
  #subtitleExtensionBtn:hover {
    width: 200px;
    padding: 0 1rem;
    border-radius: 25px;
    text-align: left;
    box-shadow: 0 15px 35px rgba(16, 185, 129, 0.4);
  }
  #subtitleExtensionBtn span {
    opacity: 0;
    transition: opacity 0.3s ease 0.15s;
    margin-left: 0.5rem;
    font-weight: 500;
  }
  #subtitleExtensionBtn:hover span {
    opacity: 1;
  }
  #subsInfoBox {
    max-width: 900px;
    margin: 2rem auto 3rem auto;
    font-size: 1rem;
    line-height: 1.6;
    padding: 2rem;
    background: var(--bg-card);
    border-radius: 24px;
    box-shadow: var(--shadow-light);
    text-align: center;
    color: var(--text-secondary);
    display: flex;
    flex-direction: column;
    align-items: center;
    animation: fadeSlideIn 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    backdrop-filter: blur(20px);
    border: var(--card-border);
  }
  [data-theme="light"] #subsInfoBox {
    background: rgba(255,255,255,0.95);
  }
  #subsInfoBox img {
    width: 180px;
    height: 270px;
    object-fit: cover;
    border-radius: 20px;
    margin-bottom: 1.5rem;
    box-shadow: var(--shadow-light);
  }
  #subsInfoBox h3 {
    color: var(--text-secondary);
    margin-bottom: 1rem;
    font-weight: 700;
    background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
  [data-theme="light"] #subsInfoBox h3 {
    background: none;
    color: var(--accent-secondary);
  }
  #subsInfoBox p {
    color: var(--text-secondary);
    margin: 0.5rem 0;
    font-size: 0.95rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
  }
  #subsInfoBox button.copy-btn {
    background: var(--button-gradient);
    border: none;
    color: #ffffff;
    padding: 0.25rem 0.75rem;
    border-radius: 8px;
    font-size: 0.75rem;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: 500;
  }
  #subsInfoBox button.copy-btn:hover {
    transform: translateY(-1px);
    box-shadow: var(--shadow-light);
  }
  #opensubLinkBox {
    margin-top: 1.5rem;
    background: var(--bg-card);
    padding: 1rem 1.5rem;
    border-radius: 16px;
    box-shadow: var(--shadow-light);
    backdrop-filter: blur(10px);
    border: var(--card-border);
  }
  #opensubLinkBox a {
    color: var(--accent-primary);
    font-weight: 600;
    font-size: 1.1rem;
    text-decoration: none;
    transition: color 0.3s ease;
  }
  #opensubLinkBox a:hover {
    color: var(--accent-secondary);
    text-decoration: underline;
  }
  #seriesSection {
    display: none;
    text-align: center;
    padding: 4rem 2rem;
  }
  .coming-soon-card {
    background: var(--bg-card);
    max-width: 500px;
    margin: 0 auto;
    padding: 3rem 2rem;
    border-radius: 24px;
    border: var(--card-border);
    box-shadow: var(--shadow-light);
    backdrop-filter: blur(20px);
    text-align: center;
    position: relative;
    overflow: hidden;
  }
  [data-theme="light"] .coming-soon-card {
    background: rgba(255,255,255,0.95);
  }
  .coming-soon-card::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle, rgba(45,55,72,0.03) 0%, transparent 70%);
    animation: rotate 20s linear infinite;
  }
  @keyframes rotate {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
  .coming-soon-content {
    position: relative;
    z-index: 1;
  }
  .coming-soon-content h3 {
    font-size: 2rem;
    font-weight: 800;
    color: var(--accent-primary);
    margin-bottom: 1rem;
    background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
  [data-theme="light"] .coming-soon-content h3 {
    background: none;
    color: var(--accent-secondary);
  }
  .coming-soon-content p {
    font-size: 1.1rem;
    color: var(--text-secondary);
    margin-bottom: 2rem;
    line-height: 1.6;
  }
  .coming-soon-icon {
    font-size: 4rem;
    color: var(--accent-primary);
    margin-bottom: 1.5rem;
    opacity: 0.7;
  }
  #seriesSearchContainer {
    display: none;
  }
  #seriesResults {
    display: none;
  }
  #seriesControls {
    display: none;
  }
  ::-webkit-scrollbar {
    width: 8px;
  }
  ::-webkit-scrollbar-track {
    background: var(--bg-secondary);
    border-radius: 10px;
  }
  ::-webkit-scrollbar-thumb {
    background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
    border-radius: 10px;
  }
  ::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(135deg, #1a202c, #2d3748);
  }
  @keyframes floatIn {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  .card, .subs-card, .similar-card {
    animation: floatIn 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
  }
</style>
</head>
<body data-theme="dark">
  <!-- Loading Spinner -->
  <div id="loadingSpinner"></div>
  
  <!-- Theme Toggle -->
  <div id="themeToggle" onclick="toggleTheme()">
    <i class="fas fa-sun"></i>
    <i class="fas fa-moon"></i>
  </div>

  <div id="main">
    <h2>IMDb Player</h2>
    <div id="modeSelector">
      <button onclick="showMode('movies')">Pel√≠culas üé¨</button>
      <button onclick="showMode('subs')">Subs üìù</button>
      <button onclick="showMode('series')">Series üì∫</button>
      <button onclick="showMode('football')">F√∫tbol ‚öΩ</button>
    </div>

    <!-- Pel√≠culas Section -->
    <div id="moviesSection" style="display:block;">
      <div id="searchContainer">
        <input type="text" id="titleInput" placeholder="Escribe el t√≠tulo..." />
        <button class="action-btn" id="searchBtn">Buscar</button>
      </div>
      <div id="results"></div>
      <div id="moviesPagination" class="pagination"></div>
      <div id="playerWrapper">
        <div id="playerControls">
          <button class="action-btn" id="loadMovieBtn" onclick="openPlayerChoiceModal()">‚ñ∂Ô∏è Cargar pel√≠cula</button>
          <input type="hidden" id="tmdbInput" value="" />
        </div>
        <div id="playerEmbedWrapper">
          <iframe id="moviePlayerIframe" src="" width="100%" height="720" style="border:none; border-radius: 16px; box-shadow: 0 12px 30px rgba(44, 156, 255, 0.7); background: #000;" allowfullscreen allow="encrypted-media"></iframe>
          <a href="https://chromewebstore.google.com/detail/kkkbiiikppgjdiebcabomlbidfodipjg?utm_source=item-share-cb" target="_blank" id="subtitleExtensionBtn" title="Extensi√≥n para subt√≠tulos" aria-label="Extensi√≥n para subt√≠tulos">
            <svg xmlns="http://www.w3.org/2000/svg" fill="white" height="24" viewBox="0 0 24 24" width="24"><path d="M3 7v10h18V7H3zm16 8H5v-6h14v6zm-3-4h-2v3h-2v-3H8v-2h2V8h2v3h2v2z"/></svg>
            <span>EXTENSI√ìN PARA SUBT√çTULOS</span>
          </a>
        </div>
        <div id="movieSynopsisBox"></div>
        <div id="similarMoviesSection" style="display:none;">
          <h3>Pel√≠culas similares a tu selecci√≥n</h3>
          <div id="similarMovies"></div>
        </div>
      </div>
    </div>

    <!-- Subs Section -->
    <div id="subsSection" style="display:none;">
      <div id="subsSearchContainer" style="display:flex; justify-content:center; gap:15px; margin-bottom:25px;">
        <input type="text" id="subsTitleInput" placeholder="Buscar pel√≠cula para subs..." />
        <button class="action-btn" id="subsSearchBtn">Buscar</button>
      </div>
      <div id="subsResults" style="display:flex; flex-wrap: wrap; justify-content:center; gap:30px 40px;"></div>
      <div id="subsInfoBox"></div>
      <div id="subsPlayerEmbedWrapper" style="margin-top: 20px; width: 100%; height: 480px; max-width: 800px; margin-left: auto; margin-right: auto; border-radius: 16px; overflow: hidden; box-shadow: 0 12px 30px rgba(44, 156, 255, 0.7); background: #000; border: var(--card-border);"></div>
    </div>

    <!-- Series Section -->
    <div id="seriesSection">
      <div class="coming-soon-card">
        <div class="coming-soon-content">
          <i class="fas fa-tv-retro coming-soon-icon"></i>
          <h3>SERIES</h3>
          <p>¬°Pr√≥ximamente disponible!</p>
          <p>Estamos trabajando en la mejor experiencia para ver tus series favoritas con la misma calidad y facilidad que nuestras pel√≠culas.</p>
          <p><strong>¬°Mantente atento a las actualizaciones!</strong></p>
        </div>
      </div>
    </div>

    <!-- F√∫tbol Section -->
    <div id="footballSection" style="display:none;">
      <div id="footballEmbedWrapper">
        <div id="footballDropdown">
          <select id="footballSiteSelect" aria-label="Seleccionar sitio de f√∫tbol">
            <option value="https://lmao.love/channels/">Ay-Lmao</option>
            <option value="https://strmd.link/">Streamed.pk</option>
            <option value="https://ovogoaal.com/">Ovogoaal</option>
          </select>
        </div>
        <iframe src="https://rivestream.org/livesports/football" allowfullscreen allow="encrypted-media" id="footballIframe"></iframe>
      </div>
    </div>
  </div>

  <!-- Modal para selecci√≥n de reproductor -->
  <div id="playerChoiceModal" role="dialog" aria-modal="true" aria-labelledby="playerChoiceTitle">
    <div id="playerChoiceContent">
      <h3 id="playerChoiceTitle">Selecciona el reproductor para la pel√≠cula</h3>
      <button class="playerChoiceBtn" data-player="VidSrc">VidSrc</button>
      <button class="playerChoiceBtn" data-player="Rive">Rive</button>
      <button id="playerChoiceCancelBtn">Cancelar</button>
    </div>
  </div>

<script>
  // Theme toggle
  function toggleTheme() {
    const body = document.body;
    const toggle = document.getElementById('themeToggle');
    const currentTheme = body.getAttribute('data-theme');
    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
    
    body.setAttribute('data-theme', newTheme);
    toggle.setAttribute('data-theme', newTheme);
    localStorage.setItem('theme', newTheme);
  }
  
  // Load saved theme
  document.addEventListener('DOMContentLoaded', () => {
    const savedTheme = localStorage.getItem('theme') || 'dark';
    document.body.setAttribute('data-theme', savedTheme);
    document.getElementById('themeToggle').setAttribute('data-theme', savedTheme);
  });
  
  // Loading functions
  function showLoading() {
    document.getElementById('loadingSpinner').style.display = 'block';
  }
  function hideLoading() {
    document.getElementById('loadingSpinner').style.display = 'none';
  }

  const tmdbApiKey = "b60c8fb1893bba0f1380297e7a40257e";
  const tmdbBaseURL = "https://api.themoviedb.org/3";
  let currentMovieId = "";
  let currentPage = 1;
  let totalPages = 1;

  function slugify(text) {
    return text.toString().toLowerCase().normalize("NFD")
      .replace(/[\u0300-\u036f]/g, "")
      .replace(/[^a-z0-9 -]/g, "")
      .replace(/\s+/g, "-")
      .replace(/-+/g, "-")
      .replace(/^-+|-+$/g, "");
  }

  function showMode(mode) {
    document.getElementById("moviesSection").style.display = (mode === "movies") ? "block" : "none";
    document.getElementById("subsSection").style.display = (mode === "subs") ? "block" : "none";
    document.getElementById("seriesSection").style.display = (mode === "series") ? "block" : "none";
    document.getElementById("footballSection").style.display = (mode === "football") ? "block" : "none";
  }

  // ---------- Pel√≠culas -----------

  const results = document.getElementById("results");
  const tmdbInput = document.getElementById("tmdbInput");
  const moviesPagination = document.getElementById("moviesPagination");
  const movieSynopsisBox = document.getElementById("movieSynopsisBox");
  const moviePlayerIframe = document.getElementById("moviePlayerIframe");

  async function startSearch() {
    showLoading();
    results.innerHTML = "";
    moviesPagination.innerHTML = "";
    movieSynopsisBox.innerHTML = "";
    currentMovieId = "";
    const currentTitle = document.getElementById("titleInput").value.trim();
    if (!currentTitle) {
      hideLoading();
      return;
    }
    await searchMovie(currentPage);
    hideLoading();
  }

  document.getElementById("searchBtn").addEventListener("click", startSearch);
  document.getElementById("titleInput").addEventListener("keydown", (event) => {
    if (event.key === "Enter") {
      event.preventDefault();
      startSearch();
    }
  });

  async function searchMovie(page) {
    try {
      const currentTitle = document.getElementById("titleInput").value.trim();
      const url = `${tmdbBaseURL}/search/movie?api_key=${tmdbApiKey}&query=${encodeURIComponent(currentTitle)}&page=${page}&language=es-ES`;
      const response = await fetch(url);
      if (!response.ok) throw new Error("Error en la respuesta de TMDB");
      const data = await response.json();
      if (!data.results || data.results.length === 0) {
        results.innerHTML = "<p>No se encontraron resultados.</p>";
        moviesPagination.innerHTML = "";
        return;
      }
      results.innerHTML = "";
      totalPages = data.total_pages;
      updatePagination(moviesPagination, "movies");
      data.results.forEach((movie) => {
        const card = document.createElement("div");
        card.className = "card";
        const poster = movie.poster_path ? `https://image.tmdb.org/t/p/w200${movie.poster_path}` : "https://via.placeholder.com/140x200?text=No+Image";
        card.innerHTML = `<img class="poster" src="${poster}"><div class="title">${movie.title} (${movie.release_date ? movie.release_date.slice(0,4) : "---"})</div>`;
        card.onclick = async () => {
          await loadMovieDetails(movie.id);
        };
        results.appendChild(card);
      });
    } catch (error) {
      results.innerHTML = `<p>Error al buscar pel√≠culas: ${error.message}</p>`;
      moviesPagination.innerHTML = "";
    }
  }

  function updatePagination(container, type) {
    container.innerHTML = "";
    if (totalPages <= 1) return;
    
    const prevBtn = document.createElement("button");
    prevBtn.textContent = "¬´ Anterior";
    prevBtn.disabled = currentPage <= 1;
    prevBtn.onclick = () => {
      if (currentPage > 1) {
        currentPage--;
        if(type === "movies") searchMovie(currentPage);
      }
    };
    container.appendChild(prevBtn);

    const pageInfo = document.createElement("span");
    pageInfo.style.color = "var(--text-secondary)";
    pageInfo.style.margin = "0 1rem";
    pageInfo.textContent = `P√°gina ${currentPage} de ${totalPages}`;
    container.appendChild(pageInfo);

    const nextBtn = document.createElement("button");
    nextBtn.textContent = "Siguiente ¬ª";
    nextBtn.disabled = currentPage >= totalPages;
    nextBtn.onclick = () => {
      if (currentPage < totalPages) {
        currentPage++;
        if(type === "movies") searchMovie(currentPage);
      }
    };
    container.appendChild(nextBtn);
  }

  async function loadMovieDetails(movieId) {
    results.innerHTML = "";
    moviesPagination.innerHTML = "";
    movieSynopsisBox.innerHTML = "";
    currentMovieId = "";
    try {
      const detailsUrl = `${tmdbBaseURL}/movie/${movieId}?api_key=${tmdbApiKey}&language=es-ES&append_to_response=credits,external_ids`;
      const detailsRes = await fetch(detailsUrl);
      if (!detailsRes.ok) {
        results.innerHTML = "<p>Error al cargar detalles de la pel√≠cula.</p>";
        return;
      }
      const details = await detailsRes.json();
      const posterLarge = details.poster_path ? `https://image.tmdb.org/t/p/w300${details.poster_path}` : "https://via.placeholder.com/150x225?text=No+Image";
      const director = details.credits.crew.find(c => c.job === "Director");
      const castTop5 = details.credits.cast.slice(0,5);
      const castNames = castTop5.map(c => c.name).join(", ");
      const expanded = document.createElement("div");
      expanded.className = "expanded-card";
      expanded.innerHTML = `
        <img src="${posterLarge}">
        <div class="expanded-info">
          <h3>${details.title} (${details.release_date ? details.release_date.slice(0,4) : "---"})</h3>
          <p><strong>Director:</strong> ${director ? director.name : "N/D"}</p>
          <p><strong>Reparto:</strong> ${castNames}</p>
          <p><strong>IMDb:</strong> <span style="color:var(--accent-primary)">${details.vote_average}</span></p>
          <p><strong>G√©nero:</strong> ${details.genres.map(g => g.name).join(", ")}</p>
          <p><strong>Duraci√≥n:</strong> ${details.runtime} min</p>
          <p><strong>Pa√≠s:</strong> ${details.production_countries.map(c => c.name).join(", ")}</p>
        </div>`;
      results.appendChild(expanded);

      tmdbInput.value = details.id || "";
      tmdbInput.setAttribute("data-title", slugify(details.title));
      movieSynopsisBox.innerHTML = `<span class="movie-synopsis-label">Sinopsis:</span> ${details.overview || "Sinopsis no disponible."}`;

      currentMovieId = details.id;

      if(currentMovieId){
        moviePlayerIframe.src = `https://rivestream.org/watch?type=movie&id=${currentMovieId}`;
      } else {
        moviePlayerIframe.src = "";
      }
    } catch (error) {
      results.innerHTML = `<p>Error al cargar detalles: ${error.message}</p>`;
    }
  }

  const playerChoiceModal = document.getElementById("playerChoiceModal");
  const playerChoiceContent = playerChoiceModal.querySelector("#playerChoiceContent");
  let playerChoiceCancelBtn = playerChoiceModal.querySelector("#playerChoiceCancelBtn");

  function openPlayerChoiceModal() {
    if (!currentMovieId) {
      alert("Por favor, selecciona primero una pel√≠cula haciendo clic en alguna tarjeta.");
      return;
    }
    playerChoiceModal.style.display = "flex";
  }

  playerChoiceContent.addEventListener("click", (event) => {
    if(event.target.classList.contains("playerChoiceBtn")){
      const player = event.target.getAttribute("data-player");
      let url = "";
      switch(player) {
        case "Rive":
          url = `https://rivestream.org/watch?type=movie&id=${currentMovieId}`;
          moviePlayerIframe.src = url;
          break;
        case "VidSrc":
          url = `https://vidsrc.xyz/embed/movie/${currentMovieId}`;
          moviePlayerIframe.src = url;
          break;
      }
      playerChoiceModal.style.display = "none";
    }
  });

  playerChoiceCancelBtn.addEventListener("click", () => {
    playerChoiceModal.style.display = "none";
  });

  window.addEventListener("click", (event) => {
    if (event.target === playerChoiceModal) {
      playerChoiceModal.style.display = "none";
    }
  });

  // Subs functionality
  const subsResults = document.getElementById("subsResults");
  const subsInfoBox = document.getElementById("subsInfoBox");

  document.getElementById("subsSearchBtn").addEventListener("click", startSubsSearch);
  document.getElementById("subsTitleInput").addEventListener("keydown", (event) => {
    if (event.key === "Enter") {
      event.preventDefault();
      startSubsSearch();
    }
  });

  async function startSubsSearch() {
    showLoading();
    const query = document.getElementById("subsTitleInput").value.trim();
    if (!query) {
      hideLoading();
      return;
    }
    subsResults.innerHTML = "";
    subsInfoBox.innerHTML = "";
    try {
      const url = `${tmdbBaseURL}/search/movie?api_key=${tmdbApiKey}&query=${encodeURIComponent(query)}&language=es-ES`;
      const response = await fetch(url);
      if (!response.ok) throw new Error("Error en la respuesta de TMDb");
      const data = await response.json();
      if (!data.results || data.results.length === 0) {
        subsResults.innerHTML = "<p>No se encontraron resultados.</p>";
        hideLoading();
        return;
      }
      data.results.forEach(movie => {
        const card = document.createElement("div");
        card.className = "subs-card";
        const poster = movie.poster_path ? `https://image.tmdb.org/t/p/w200${movie.poster_path}` : "https://via.placeholder.com/140x200?text=No+Image";
        card.innerHTML = `<img class="poster" src="${poster}"><div class="title">${movie.title} (${movie.release_date ? movie.release_date.slice(0,4) : "---"})</div>`;
        card.onclick = () => loadSubsByMovieId(movie.id);
        subsResults.appendChild(card);
      });
      hideLoading();
    } catch (error) {
      subsResults.innerHTML = `<p>Error al buscar pel√≠culas: ${error.message}</p>`;
      hideLoading();
    }
  }

  function formatImdbIdForOpenSub(imdbId) {
    if (!imdbId) return "";
    let numPart = imdbId.toLowerCase().replace(/^tt/, "");
    numPart = numPart.replace(/^0+/, "");
    return numPart;
  }

  async function loadSubsByMovieId(movieId) {
    subsResults.innerHTML = "";
    subsInfoBox.innerHTML = "";
    try {
      const detailsUrl = `${tmdbBaseURL}/movie/${movieId}?api_key=${tmdbApiKey}&language=es-ES`;
      const detailsRes = await fetch(detailsUrl);
      if (!detailsRes.ok) {
        subsResults.innerHTML = "<p>Error al obtener datos de la pel√≠cula.</p>";
        return;
      }
      const details = await detailsRes.json();
      const year = details.release_date ? details.release_date.slice(0,4) : "";
      const poster = details.poster_path ? `https://image.tmdb.org/t/p/w300${details.poster_path}` : "https://via.placeholder.com/150x225?text=No+Image";
      const imdbIdRaw = details.imdb_id || "";
      const imdbIdFormatted = formatImdbIdForOpenSub(imdbIdRaw);
      const tmdbId = details.id || "N/D";

      const openSubUrl = `https://www.opensubtitles.org/es/search/sublanguageid-spa/moviefps-23.976/imdbid-${imdbIdFormatted}`;

      subsInfoBox.innerHTML = `
        <img src="${poster}" alt="${details.title}" />
        <h3>${details.title} (${year})</h3>
        <p><strong>IMDb ID:</strong> ${imdbIdRaw} <button class="copy-btn" onclick="copyToClipboard('${imdbIdRaw}')">Copiar</button></p>
        <p><strong>TMDb ID:</strong> ${tmdbId} <button class="copy-btn" onclick="copyToClipboard('${tmdbId}')">Copiar</button></p>
        <div id="opensubLinkBox">
          <a href="${openSubUrl}" target="_blank" rel="noopener noreferrer" aria-label="Ver subt√≠tulos en OpenSubtitles para ${details.title}">
            Ver subt√≠tulos en OpenSubtitles
          </a>
        </div>
      `;
    } catch (error) {
      subsResults.innerHTML = `<p>Error al cargar subt√≠tulos: ${error.message}</p>`;
    }
  }

  function copyToClipboard(text) {
    navigator.clipboard.writeText(text).then(() => {
      alert("Copiado al portapapeles: " + text);
    }).catch(() => {
      alert("No se pudo copiar al portapapeles");
    });
  }

  // Football functionality
  const footballSiteSelect = document.getElementById("footballSiteSelect");
  const footballIframe = document.getElementById("footballIframe");

  footballSiteSelect.addEventListener("change", () => {
    const url = footballSiteSelect.value;
    footballIframe.src = url;
  });

  showMode("movies");
</script>
</body>
</html>





